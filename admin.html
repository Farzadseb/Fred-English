<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª ÙØ±Ø²Ø§Ø¯</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: Tahoma; background: #0f172a; color: white; display: flex; flex-direction: column; align-items: center; padding-top: 50px; }
        .box { background: #1e293b; padding: 25px; border-radius: 20px; width: 320px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px; }
        input { width: 90%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 1px solid #334155; background: #0f172a; color: white; text-align: center; }
        button { width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .btn-save { background: #00a8ff; color: white; }
        .btn-cache { background: #eb4d4b; color: white; margin-top: 20px; }
        .btn-cache:hover { background: #ff7675; }
        i { margin-left: 8px; }
    </style>
</head>
<body>
    <div class="box">
        <h3><i class="fas fa-robot"></i> ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø±Ø¨Ø§Øª</h3>
        <input type="text" id="token" placeholder="Bot Token">
        <input type="text" id="chatid" placeholder="Chat ID">
        <button class="btn-save" onclick="save()"><i class="fas fa-save"></i> Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</button>
    </div>

    <div class="box" style="border: 1px solid #eb4d4b;">
        <h3><i class="fas fa-tools"></i> Ø§Ø¨Ø²Ø§Ø± Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ</h3>
        <p style="font-size: 12px; color: #94a3b8;">Ø§Ú¯Ø± Ù„ØºØ§Øª Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ø¯Ø± Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Ø¢Ù¾Ø¯ÛŒØª Ú©Ø±Ø¯ÛŒØŒ Ø§ÛŒÙ† Ø¯Ú©Ù…Ù‡ Ø±Ø§ Ø¨Ø²Ù†:</p>
        <button class="btn-cache" onclick="clearAppCache()"><i class="fas fa-sync-alt"></i> Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ú©Ø´ Ùˆ Ø¢Ù¾Ø¯ÛŒØª Ù„ØºØ§Øª</button>
    </div>

    <script>
        function save() {
            const config = {
                token: document.getElementById('token').value,
                chatId: document.getElementById('chatid').value
            };
            localStorage.setItem('fredTelegramConfig', JSON.stringify(config));
            alert("âœ… ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.");
        }

        async function clearAppCache() {
            if (confirm("Ø¢ÛŒØ§ Ø§Ø² Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ú©Ø´ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ (Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯)")) {
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù„ØºØ§Øª
                const studentName = localStorage.getItem('fredCurrentStudent');
                const config = localStorage.getItem('fredTelegramConfig');
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ø´ Ù…Ø±ÙˆØ±Ú¯Ø± (Service Workers)
                if (window.caches) {
                    const cacheNames = await caches.keys();
                    await Promise.all(cacheNames.map(name => caches.delete(name)));
                }
                
                // Ø±ÙØ±Ø´ Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ø§Ø² Ø³Ø±ÙˆØ±
                location.reload(true);
                alert("ğŸš€ Ú©Ø´ Ù¾Ø§Ú© Ø´Ø¯! Ø­Ø§Ù„Ø§ Ø¢Ø®Ø±ÛŒÙ† Ù†Ø³Ø®Ù‡ Ù„ØºØ§Øª Ø§Ø² Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.");
            }
        }

        window.onload = () => {
            const saved = localStorage.getItem('fredTelegramConfig');
            if(saved) {
                const data = JSON.parse(saved);
                document.getElementById('token').value = data.token;
                document.getElementById('chatid').value = data.chatId;
            }
        }
    </script>
</body>
</html>
