<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz</title>

<style>
body{
font-family:sans-serif;
background:#f2f2f7;
margin:0;
padding:20px;
display:flex;
flex-direction:column;
align-items:center
}
.card{
width:100%;
max-width:400px;
background:white;
border-radius:16px;
padding:20px;
margin-bottom:15px;
text-align:center
}
button{
width:100%;
padding:14px;
margin-top:10px;
border-radius:12px;
border:none;
font-size:16px;
cursor:pointer
}
.correct{background:#34c759;color:white}
.wrong{background:#ff3b30;color:white}
</style>
</head>

<body>

<div class="card">
<h2 id="question">...</h2>
<p id="sub"></p>
</div>

<div id="options" style="width:100%;max-width:400px"></div>

<script src="a1-words.js"></script>
<script>
let qIndex = 0;
let score = 0;
const mode = localStorage.getItem("quizMode") || "def-word";
const words = window.words;

function showQuestion(){
if(qIndex >= 10){
alert("پایان آزمون\nامتیاز: " + score + "/10");
location.href = "index.html";
return;
}

const q = words[Math.floor(Math.random()*words.length)];

let questionText = "";
let correct = "";

if(mode === "def-word"){
questionText = q.definition;
correct = q.word;
document.getElementById("sub").innerText =
"این تعریف مربوط به کدام کلمه است؟";
}
else if(mode === "fa-en"){
questionText = q.translation;
correct = q.word;
document.getElementById("sub").innerText =
"معادل انگلیسی را انتخاب کنید";
}
else{
questionText = q.word;
correct = q.translation;
document.getElementById("sub").innerText =
"معادل فارسی را انتخاب کنید";
}

document.getElementById("question").innerText = questionText;

let opts = [correct];
while(opts.length < 4){
const r = words[Math.floor(Math.random()*words.length)];
const val = mode==="en-fa" ? r.translation : r.word;
if(val && !opts.includes(val)) opts.push(val);
}
opts.sort(()=>Math.random()-0.5);

const box = document.getElementById("options");
box.innerHTML = "";

opts.forEach(o=>{
const b = document.createElement("button");
b.innerText = o;
b.onclick = ()=>{
if(o === correct){
b.className = "correct";
score++;
}else{
b.className = "wrong";
}
setTimeout(()=>{
qIndex++;
showQuestion();
},800);
};
box.appendChild(b);
});
}

showQuestion();
</script>
</body>
</html>
