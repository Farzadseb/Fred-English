<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
<title>Fred English â€“ Pro</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root{--bg:#f2f2f7;--txt:#1c1c1e;--crd:#fff;--blu:#007aff;--gld:#ffcc00;--red:#ff3b30;--grn:#00b894;--st:env(safe-area-inset-top);--sb:env(safe-area-inset-bottom)}
body.dark{--bg:#0b1426;--txt:#fff;--crd:rgba(255,255,255,.12)}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;outline:none}
body{margin:0;padding:calc(var(--st) + 14px) 18px calc(var(--sb) + 14px);font-family:-apple-system,sans-serif;background:var(--bg);color:var(--txt);display:flex;justify-content:center;min-height:100dvh}
.app{width:100%;max-width:400px}
.bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
.ibtn{width:44px;height:44px;border-radius:14px;background:var(--crd);display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid rgba(0,0,0,.05);box-shadow:0 2px 5px rgba(0,0,0,.02)}
.card{background:var(--crd);border-radius:24px;padding:18px;margin-bottom:12px;border:1px solid rgba(0,0,0,.05);text-align:center;box-shadow:0 3px 12px rgba(0,0,0,.03)}
.star{width:56px;height:56px;border-radius:18px;margin:0 auto 10px;background:rgba(255,204,0,.15);border:2px solid var(--gld);display:flex;align-items:center;justify-content:center;transform:rotate(8deg)}
.btn{width:100%;padding:17px;border-radius:20px;border:none;font-weight:700;font-size:16px;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;margin-bottom:10px;position:relative;transition:transform .1s;box-shadow:0 4px 10px rgba(0,0,0,.05)}
.btn i{position:absolute;left:18px;font-size:18px}
.btn:active{transform:scale(.96)}
input{width:100%;padding:15px;border-radius:16px;border:1.5px solid rgba(0,0,0,.08);background:var(--bg);color:var(--txt);font-size:17px;text-align:center;margin:12px 0}
#prog{display:none;position:fixed;inset:0;z-index:999;background:var(--bg);padding:calc(var(--st) + 16px) 20px;overflow:auto}
.p-bar{height:12px;border-radius:6px;background:rgba(0,0,0,.1);overflow:hidden;margin:15px 0}
.p-fill{height:100%;width:0;background:var(--blu);transition:1s cubic-bezier(.2,.8,.2,1)}
.smallpill{color:var(--blu);background:rgba(0,122,255,.12);padding:5px 15px;border-radius:18px;font-weight:700;font-size:13px;display:inline-block}
</style>
</head>
<body>
<div class="app">
  <div class="bar">
    <div class="ibtn" onclick="toggleTheme()"><i id="ti" class="fas fa-moon"></i></div>
    <b style="color:var(--blu);font-size:20px">English with Fred</b>
    <div class="ibtn" onclick="toggleMute()"><i id="mi" class="fas fa-volume-up"></i></div>
  </div>

  <div id="login" class="card">
    <div class="star"><i class="fas fa-star" style="color:var(--gld);font-size:26px"></i></div>
    <h3>Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ!</h3>
    <input id="userName" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§..." autocomplete="off" />
    <button class="btn" style="background:var(--blu)" onclick="loginUser()">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú©Ù„Ø§Ø³</button>
  </div>

  <div id="menu" style="display:none">
    <div class="card">
      <div id="stars" style="color:var(--gld);margin-bottom:6px;font-size:18px;letter-spacing:4px"></div>
      <div id="hello" style="font-weight:800;font-size:19px"></div>
      <div style="margin-top:8px"><small id="best" class="smallpill"></small></div>
    </div>
    <button class="btn" style="background:#9b59b6" onclick="go('study')">Ø¢Ù…ÙˆØ²Ø´ Ù„ØºØ§Øª ğŸ“š</button>
    <button class="btn" style="background:#00a8ff" onclick="go('fa-en')">Persian â†’ English</button>
    <button class="btn" style="background:#0984e3" onclick="go('en-fa')">English â†’ Persian</button>
    <button class="btn" style="background:var(--grn)" onclick="go('word-def')">Word â†’ Definition</button>
    <button class="btn" style="background:var(--grn)" onclick="go('def-word')">Definition â†’ Word</button>
    <button class="btn" style="background:#2ecc71" onclick="openWA()">ÙˆØ§ØªØ³â€ŒØ§Ù¾ <i class="fab fa-whatsapp"></i></button>
    <button class="btn" style="background:#f39c12" onclick="openProg()">Ú¯Ø²Ø§Ø±Ø´ Ù¾ÛŒØ´Ø±ÙØª <i class="fas fa-chart-line"></i></button>
    <button class="btn" style="background:#e74c3c" onclick="logout()">Ø®Ø±ÙˆØ¬ <i class="fas fa-sign-out-alt"></i></button>
  </div>
</div>

<div id="prog">
  <div class="app" style="margin:0 auto">
    <div class="bar">
      <div class="ibtn" onclick="closeProg()"><i class="fas fa-arrow-right"></i></div>
      <b>ÙˆØ¶Ø¹ÛŒØª ØªØ­ØµÛŒÙ„ÛŒ</b>
      <div style="width:44px"></div>
    </div>
    <div class="card">
      <h2 id="avg" style="color:var(--blu);font-size:45px;margin:8px 0">0%</h2>
      <div class="p-bar"><div id="fill" class="p-fill"></div></div>
    </div>
    <div id="history"></div>
  </div>
</div>

<script>
const ls = localStorage;
const TOKEN = atob("ODU1MzIyNDUxNDpBQUcwWFh6QThkYTU1akNHWG56U3RQLTBJeEhobmZrVFBSdw==");
const CHAT = atob("OTY5OTE4NTk=");

async function tg(text){
  try{ await fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({chat_id:CHAT,text})});}catch(e){}
}

function toggleTheme(){
  const d = document.body.classList.toggle('dark');
  ls.setItem('t', d ? 'd' : 'l');
  ti.className = d ? 'fas fa-sun' : 'fas fa-moon';
}

function toggleMute(){
  const m = ls.getItem('m') === 'y';
  ls.setItem('m', m ? 'n' : 'y');
  mi.className = m ? 'fas fa-volume-up' : 'fas fa-volume-mute';
}

function loginUser(){
  const n = document.getElementById('userName').value.trim();
  if(!n) return;
  ls.setItem('fn', n);
  tg(`âœ… ÙˆØ±ÙˆØ¯: ${n}`);
  init();
}

function init(){
  const u = ls.getItem('fn');
  document.getElementById('login').style.display = u ? 'none' : 'block';
  document.getElementById('menu').style.display = u ? 'block' : 'none';
  if(!u) return;
  document.getElementById('hello').innerText = `Ø³Ù„Ø§Ù… ${u}`;
  const b = parseInt(ls.getItem('fb') || '0');
  document.getElementById('best').innerText = `Best: ${b}%`;
  const sc = Math.floor(b/20);
  document.getElementById('stars').innerHTML = Array.from({length:5},(_,i)=>i<sc?'<i class="fas fa-star"></i>':'<i class="far fa-star"></i>').join('');
}

function openProg(){
  document.getElementById('prog').style.display = 'block';
  const h = JSON.parse(ls.getItem('fh') || '[]');
  const his = document.getElementById('history'); his.innerHTML = '';
  if(!h.length){ his.innerHTML = '<div class="card">Ø®Ø§Ù„ÛŒ</div>'; return; }
  let t = 0;
  h.slice(-10).reverse().forEach((s,i)=>{
    t += s;
    his.innerHTML += `<div class="card" style="display:flex;justify-content:space-between"><span>ØªÙ…Ø±ÛŒÙ† ${h.length-i}</span><b>${s}%</b></div>`;
  });
  const a = Math.round(t/Math.min(h.length,10));
  document.getElementById('avg').innerText = a + '%';
  setTimeout(()=>document.getElementById('fill').style.width=a+'%',100);
}

function closeProg(){ document.getElementById('prog').style.display = 'none'; }
function logout(){ if(confirm('Ø®Ø±ÙˆØ¬ØŸ')){ ls.clear(); location.reload(); }}
function go(m){ ls.setItem('qm', m); location.href='quiz.html'; }
function openWA(){ window.open('https://wa.me/989017708544'); }

window.onload = () => {
  if(ls.getItem('t') === 'd') { document.body.classList.add('dark'); ti.className='fas fa-sun'; }
  if(ls.getItem('m') === 'y') mi.className='fas fa-volume-mute';
  init();
};
</script>
</body>
</html>
