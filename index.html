<!-- =======================
     index.html (FULL)
======================= -->
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />
  <title>English with Fred</title>

  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />

  <!-- Font (optional) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;800&display=swap" rel="stylesheet">

  <!-- Icons (FontAwesome) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body class="dark-theme">
  <!-- Notification -->
  <div id="notification" class="notification info" aria-live="polite"></div>

  <!-- Install Banner (Android) -->
  <div id="installBanner" class="install-banner" style="display:none;">
    <div class="banner-content">
      <i class="fas fa-download"></i>
      <div class="banner-text">
        <strong>ูุตุจ ุจุฑูุงูู</strong>
        <small>ุจุฑุง ุฏุณุชุฑุณ ุณุฑุนโุชุฑ ูุตุจ ฺฉูุฏ</small>
      </div>
      <button class="install-btn" onclick="installPWA()">
        <i class="fas fa-download"></i> ูุตุจ
      </button>
      <button class="close-banner" onclick="hideInstallBanner()">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>

  <!-- iOS Install Hint -->
  <div id="iosInstallHint" class="ios-hint" style="display:none;">
    <div class="ios-hint-card">
      <div class="ios-hint-title"><i class="fa-solid fa-apple-whole"></i> ูุตุจ ุฑู ุขููู</div>
      <div class="ios-hint-text">
        ุฏุฑ Safari ุฑู <b>Share</b> ุจุฒูุฏ ู ฺฏุฒูู <b>Add to Home Screen</b> ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
      </div>
      <button class="btn btn-primary" onclick="hideIOSHint()">ุจุงุดู</button>
    </div>
  </div>

  <!-- Top Bar -->
  <header class="topbar">
    <div class="brand">
      <div class="logo">F</div>
      <div class="title">
        <div class="appname">English with Fred</div>
        <div class="subtitle">ูุบุช โข ุขุฒููู โข ุงุฏฺฏุฑ</div>
      </div>
    </div>

    <div class="top-actions">
      <button id="themeToggle" class="icon-btn theme-btn" title="ุชุบุฑ ุชู">
        <i class="fas fa-sun"></i>
      </button>
      <button id="globalMuteBtn" class="icon-btn mute-btn" title="ูุทุน/ูุตู ุตุฏุง">
        <i class="fas fa-volume-up"></i>
      </button>
    </div>
  </header>

  <!-- Views -->
  <main class="main">

    <!-- LOGIN -->
    <section id="login" class="view active">
      <div class="card">
        <h2 class="card-title">ูุฑูุฏ</h2>

        <div class="form">
          <label class="label">ูุงู</label>
          <input id="usernameInput" class="input" type="text" placeholder="ูุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ" autocomplete="name" />

          <label class="label">ฺฉุฏ ุฒุจุงูโุขููุฒ (ุงุฎุชุงุฑ)</label>
          <input id="studentCodeInput" class="input" type="text" placeholder="ุงุฎุชุงุฑ" />

          <button class="btn btn-primary" onclick="saveUserInfo()">
            <i class="fas fa-check"></i> ุดุฑูุน
          </button>

          <button class="btn btn-ghost" onclick="showIOSHint()">
            <i class="fas fa-download"></i> ูุตุจ ุฏุณุช (ุขููู)
          </button>
        </div>
      </div>
    </section>

    <!-- HOME -->
    <section id="home" class="view">
      <div class="home-head">
        <div class="hello">
          ุณูุงู <b id="currentUsername">โ</b> ๐
        </div>

        <div class="mini-stats">
          <div class="pill">
            <i class="fa-solid fa-trophy"></i>
            <span>ุจูุชุฑู ุงูุชุงุฒ:</span>
            <b id="bestScore">0%</b>
          </div>
          <div class="pill">
            <i class="fa-solid fa-fire"></i>
            <span>Streak:</span>
            <b id="streakCount">0</b>
          </div>
        </div>

        <div class="stars" aria-label="stars">
          <i class="far fa-star"></i>
          <i class="far fa-star"></i>
          <i class="far fa-star"></i>
          <i class="far fa-star"></i>
          <i class="far fa-star"></i>
        </div>

        <div id="badgeRow" class="badge-row"></div>
      </div>

      <div class="menu-grid">
        <button class="menu-btn gradient-a1" onclick="startA1Learning()">
          <i class="fas fa-book-open"></i>
          <span>ุงุฏฺฏุฑ A1</span>
        </button>

        <button id="a2Btn" class="menu-btn gradient-a2 disabled" onclick="startA2Learning()">
          <i class="fas fa-level-up-alt"></i>
          <span>ุดุฑูุน A2</span>
          <small id="a2LockText">ููู (A1โฅ80%)</small>
        </button>

        <button class="menu-btn gradient-quiz" onclick="openQuizMenu()">
          <i class="fas fa-question-circle"></i>
          <span>ุดุฑูุน ุขุฒููู</span>
        </button>

        <button class="menu-btn gradient-report" onclick="showLearningReport()">
          <i class="fas fa-chart-line"></i>
          <span>ฺฏุฒุงุฑุด ุงุฏฺฏุฑ</span>
        </button>

        <button class="menu-btn gradient-mistakes" onclick="openMistakes()">
          <i class="fas fa-dumbbell"></i>
          <span>ุชูุฑู ุงุดุชุจุงูุงุช</span>
        </button>

        <button class="menu-btn gradient-progress" onclick="showProgressReport()">
          <i class="fas fa-clipboard-list"></i>
          <span>ฺฏุฒุงุฑุด ุขุฒูููโูุง</span>
        </button>

        <button class="menu-btn gradient-leitner" onclick="leitnerSystem.showLeitnerStats()">
          <i class="fas fa-brain"></i>
          <span>ูุงุชูุฑ</span>
        </button>

        <button class="menu-btn gradient-whatsapp" onclick="joinWhatsApp()">
          <i class="fab fa-whatsapp"></i>
          <span>ุซุจุชโูุงู ูุงุชุณุงูพ</span>
        </button>

        <button class="menu-btn gradient-exit" onclick="showExitOptions()">
          <i class="fas fa-sign-out-alt"></i>
          <span>ุฎุฑูุฌ / ุชุบุฑ ฺฉุงุฑุจุฑ</span>
        </button>
      </div>

      <div class="manual-install">
        <button class="btn btn-secondary" onclick="tryManualInstall()">
          <i class="fas fa-download"></i> ูุตุจ (ุฏุณุช/ุงูุฏุฑูุฏ)
        </button>
      </div>
    </section>

    <!-- LEARNING -->
    <section id="learning" class="view">
      <div class="top-row">
        <div class="title2">
          <div class="t1">ุงุฏฺฏุฑ ูุบุงุช</div>
          <div class="t2">ฺฉุงุฑุจุฑ: <b id="learningUsername">โ</b></div>
        </div>

        <div class="right-tools">
          <button class="icon-btn" onclick="toggleExample()" title="ููุงุด/ูุฎู ูุซุงู">
            <i class="fas fa-comment-alt"></i>
          </button>
          <button class="icon-btn" onclick="toggleMarkWord()" title="ุนูุงูุชโฺฏุฐุงุฑ">
            <i class="fas fa-thumbtack"></i>
          </button>
          <button class="icon-btn" onclick="speakCurrentWord()" title="ุชููุธ">
            <i class="fas fa-volume-up"></i>
          </button>
        </div>
      </div>

      <div class="progress-bar">
        <div id="learningProgressFill" class="progress-fill"></div>
      </div>

      <div class="learning-info">
        <div>ูุบุช: <b id="currentWordIndex">1</b> / <b id="totalWords">0</b></div>
        <div>ุชุณูุท A1: <b id="a1MasteryPercent">0%</b></div>
      </div>

      <div id="wordCard" class="word-card"></div>

      <div class="actions-row">
        <button id="prevBtn" class="btn btn-ghost" onclick="prevWord()">
          <i class="fas fa-arrow-right"></i> ูุจู
        </button>
        <button class="btn btn-secondary" onclick="startPractice()">
          <i class="fas fa-dumbbell"></i> ุชูุฑู
        </button>
        <button id="nextBtn" class="btn btn-primary" onclick="nextWord()">
          ุจุนุฏ <i class="fas fa-arrow-left"></i>
        </button>
      </div>

      <div class="actions-row">
        <button class="btn btn-ghost" onclick="switchView('home')">
          <i class="fas fa-home"></i> ุฎุงูู
        </button>
        <button class="btn btn-primary" onclick="finishLearning()">
          <i class="fas fa-flag-checkered"></i> ูพุงุงู ู ุขุฒููู
        </button>
      </div>
    </section>

    <!-- QUIZ MENU -->
    <section id="quizMenu" class="view">
      <div class="card">
        <h2 class="card-title">ุงูุชุฎุงุจ ููุน ุขุฒููู</h2>
        <div class="quiz-modes">
          <button class="menu-btn gradient-quiz" onclick="startQuiz('english-persian', 10)">
            ุงูฺฏูุณ โ ูุงุฑุณ
          </button>
          <button class="menu-btn gradient-quiz" onclick="startQuiz('persian-english', 10)">
            ูุงุฑุณ โ ุงูฺฏูุณ
          </button>
          <button class="menu-btn gradient-quiz" onclick="startQuiz('word-definition', 10)">
            ฺฉููู โ ุชุนุฑู
          </button>
          <button class="menu-btn gradient-quiz" onclick="startQuiz('definition-word', 10)">
            ุชุนุฑู โ ฺฉููู
          </button>
          <button class="menu-btn gradient-leitner" onclick="leitnerSystem.startLeitnerQuiz()">
            ูุฑูุฑ ูุงุชูุฑ (Due)
          </button>
        </div>

        <div class="actions-row">
          <button class="btn btn-ghost" onclick="switchView('home')">
            <i class="fas fa-home"></i> ุฎุงูู
          </button>
        </div>
      </div>
    </section>

    <!-- QUIZ -->
    <section id="quiz" class="view">
      <div class="quiz-top">
        <div class="quiz-title">
          <div>ฺฉุงุฑุจุฑ: <b id="quizUsername">โ</b></div>
          <div class="quiz-meta">
            ุณูุงู <b id="currentQuestion">1</b> ุงุฒ <b id="totalQuestions">10</b> โข ุงูุชุงุฒ: <b id="quizScore">0</b>
          </div>
        </div>

        <button class="btn btn-ghost" onclick="confirmExitQuiz()">
          <i class="fas fa-xmark"></i> ุฎุฑูุฌ
        </button>
      </div>

      <div class="progress-bar">
        <div id="progressFill" class="progress-fill"></div>
      </div>

      <div class="card">
        <div class="question-row">
          <div id="questionText" class="question-text">โ</div>
          <button class="icon-btn" onclick="speakQuizQuestion()" title="ุชููุธ ุณูุงู">
            <i class="fas fa-volume-up"></i>
          </button>
        </div>

        <div id="quizOptions" class="options-grid"></div>
      </div>
    </section>

    <!-- RESULTS -->
    <section id="results" class="view">
      <div class="card">
        <h2 class="card-title">ูุชุฌู ุขุฒููู</h2>

        <div class="results-grid">
          <div class="result-box">
            <div class="rb-title">ุงูุชุงุฒ</div>
            <div id="finalScore" class="rb-value">0%</div>
          </div>
          <div class="result-box">
            <div class="rb-title">ุฏุฑุณุช</div>
            <div id="correctCount" class="rb-value">0</div>
          </div>
          <div class="result-box">
            <div class="rb-title">ฺฉู</div>
            <div id="totalCount" class="rb-value">0</div>
          </div>
          <div class="result-box">
            <div class="rb-title">ุฒูุงู</div>
            <div id="quizTime" class="rb-value">0 ุซุงูู</div>
          </div>
        </div>

        <div id="motivationMsg" class="motivation">โ</div>

        <div class="actions-row">
          <button class="btn btn-primary" onclick="openQuizMenu()">
            <i class="fas fa-rotate-right"></i> ุขุฒููู ุฏูุจุงุฑู
          </button>
          <button class="btn btn-secondary" onclick="openMistakes()">
            <i class="fas fa-dumbbell"></i> ุชูุฑู ุงุดุชุจุงูุงุช
          </button>
          <button class="btn btn-ghost" onclick="switchView('home')">
            <i class="fas fa-home"></i> ุฎุงูู
          </button>
        </div>
      </div>
    </section>

    <!-- MISTAKES -->
    <section id="mistakes" class="view">
      <div class="card">
        <h2 class="card-title">ุงุดุชุจุงูุงุช</h2>
        <div class="muted">ุงู ุจุฎุด ุงุฒ ุขุฎุฑู ุงุดุชุจุงูุงุช ุดูุง ุชูุฑู ูโุณุงุฒุฏ.</div>

        <div id="mistakesList" class="mistakes-list"></div>

        <div class="actions-row">
          <button class="btn btn-primary" onclick="startMistakesQuiz()">
            <i class="fas fa-play"></i> ุดุฑูุน ุชูุฑู
          </button>
          <button class="btn btn-ghost" onclick="switchView('home')">
            <i class="fas fa-home"></i> ุฎุงูู
          </button>
        </div>
      </div>
    </section>

  </main>

  <!-- Scripts (order ููู) -->
  <script src="a1-words.js"></script>
  <script src="mistake-storage.js"></script>
  <script src="leitner.js"></script>
  <script src="telegram-integration.js"></script>
  <script src="install-promotion.js"></script>
  <script src="learning-engine.js"></script>
  <script src="quiz-engine.js"></script>
  <script src="app.js"></script>
</body>
                                     </html>
