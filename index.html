<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Fred English</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    <style>
        :root { --bg:#f2f2f7; --txt:#1c1c1e; --crd:#fff; --blu:#007aff; --gld:#ffcc00; --red:#ff3b30; --grn:#00b894; --st:env(safe-area-inset-top); --sb:env(safe-area-inset-bottom); }
        body.dark-mode { --bg:#0b1426; --txt:#fff; --crd:rgba(255,255,255,0.1); }
        * { box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
        body { font-family:-apple-system,BlinkMacSystemFont,sans-serif; background:var(--bg); color:var(--txt); margin:0; padding:calc(var(--st) + 5px) 15px calc(var(--sb) + 10px); display:flex; flex-direction:column; align-items:center; min-height:100dvh; transition:0.2s; overflow-x:hidden; justify-content: flex-start; }
        .app { width:100%; max-width:390px; }
        .bar { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; width:100%; }
        .ibtn { width:38px; height:38px; background:var(--crd); border-radius:10px; display:flex; align-items:center; justify-content:center; cursor:pointer; border:1px solid rgba(0,0,0,0.05); }
        .card { background:var(--crd); padding:12px 15px; border-radius:20px; text-align:center; border:1px solid rgba(0,0,0,0.05); margin-bottom:8px; box-shadow:0 2px 8px rgba(0,0,0,0.02); }
        .star { width:50px; height:50px; background:rgba(255,204,0,0.1); border:2px solid var(--gld); border-radius:15px; display:flex; align-items:center; justify-content:center; margin:0 auto 8px; transform:rotate(8deg); }
        .btn { width:100%; padding:14px; border-radius:16px; color:#fff; font-weight:700; border:none; font-size:15px; cursor:pointer; display:flex; align-items:center; justify-content:center; margin-bottom:7px; position:relative; text-decoration:none; transition:0.1s; }
        .btn:active { transform:scale(0.98); }
        .btn i { position:absolute; left:12px; font-size:16px; }
        input { width:100%; padding:12px; border-radius:12px; border:1px solid rgba(0,0,0,0.1); margin:8px 0; text-align:center; font-size:16px; background:var(--bg); color:var(--txt); outline:none; }
        #prog { display:none; position:fixed; top:0; left:0; width:100%; height:100dvh; background:var(--bg); z-index:99; padding:calc(var(--st) + 10px) 15px; overflow-y:auto; }
        .p-bar { width:100%; height:8px; background:rgba(0,0,0,0.1); border-radius:4px; margin:10px 0; overflow:hidden; }
        .p-fill { height:100%; background:var(--blu); width:0%; transition:0.8s; }
    </style>
</head>
<body>
    <div class="app">
        <div class="bar">
            <div class="ibtn" onclick="th()"><i id="ti" class="fas fa-moon"></i></div>
            <b style="color:var(--blu); font-size:17px;">English with Fred</b>
            <div class="ibtn" onclick="mu()"><i id="mi" class="fas fa-volume-up"></i></div>
        </div>

        <div id="s-pg" class="card" style="padding:20px 15px;">
            <div class="star"><i class="fas fa-star" style="color:var(--gld)"></i></div>
            <h4 style="margin:5px 0;">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ</h4>
            <input type="text" id="ni" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§">
            <button onclick="sv()" class="btn" style="background:var(--blu)">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡</button>
        </div>

        <div id="m-pg" style="display:none">
            <div class="card" style="padding:10px;">
                <div id="sd" style="color:var(--gld); margin-bottom:4px; font-size:14px; letter-spacing:2px;"></div>
                <div id="hu" style="font-weight:800; font-size:16px;"></div>
                <small id="bs" style="color:var(--blu); font-weight:bold; font-size:11px;"></small>
            </div>
            
            <button class="btn" style="background:#9b59b6" onclick="go('study')">Ø¢Ù…ÙˆØ²Ø´ Ù„ØºØ§Øª ğŸ“š</button>
            <button class="btn" style="background:#00a8ff" onclick="go('fa-en')">Farsi â†’ English</button>
            <button class="btn" style="background:#0984e3" onclick="go('en-fa')">English â†’ Farsi</button>
            <button class="btn" style="background:var(--grn)" onclick="go('word-def')">Word â†’ Definition</button>
            <button class="btn" style="background:var(--grn)" onclick="go('def-word')">Definition â†’ Word</button>
            
            <div class="card" style="background:rgba(255,59,48,0.05); padding:8px; border:1px dashed var(--red); margin-bottom:8px;">
                <small style="color:var(--red); font-weight:700; font-size:12px;">ğŸ§  Ú†Ø§Ù„Ø´ Ú©Ù„Ù…Ø§Øª Ø§Ø´ØªØ¨Ø§Ù‡</small>
            </div>
            
            <button class="btn" style="background:#2ecc71" onclick="window.open('https://wa.me/989017708544')">ÙˆØ§ØªØ³â€ŒØ§Ù¾ <i class="fab fa-whatsapp"></i></button>
            <button class="btn" style="background:#f39c12" onclick="op()">Ù¾ÛŒØ´Ø±ÙØª <i class="fas fa-chart-line"></i></button>
            <button class="btn" style="background:#e74c3c" onclick="lo()">Ø®Ø±ÙˆØ¬ <i class="fas fa-sign-out-alt"></i></button>
        </div>
    </div>

    <div id="prog">
        <div class="bar"><div class="ibtn" onclick="cp()"><i class="fas fa-arrow-right"></i></div><b>Ú¯Ø²Ø§Ø±Ø´ Ø¹Ù…Ù„Ú©Ø±Ø¯</b><div></div></div>
        <div class="card"><h2 id="ap" style="margin:5px 0;">0%</h2><div class="p-bar"><div id="pf" class="p-fill"></div></div></div>
        <div id="hl"></div>
    </div>

    <script>
        const _eT = "ODU1MzIyNDUxNDpBQUcwWFh6QThkYTU1akNHWG56U3RQLTBJeEhobmZrVFBSdw==";
        const _eI = "OTY5OTE4NTk=";
        const ls=localStorage;

        async function tg(m){ 
            try{
                const t=atob(_eT), i=atob(_eI);
                await fetch(`https://api.telegram.org/bot${t}/sendMessage`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({chat_id:i,text:m})});
            }catch(e){}
        }

        function th(){ const d=document.body.classList.toggle('dark-mode'); ls.setItem('t', d?'d':'l'); document.getElementById('ti').className=d?'fas fa-sun':'fas fa-moon'; }
        function mu(){ const m=ls.getItem('m')==='y'; ls.setItem('m', m?'n':'y'); document.getElementById('mi').className=m?'fas fa-volume-mute':'fas fa-volume-up'; }
        
        function sv(){ 
            const n=document.getElementById('ni').value.trim(); 
            if(n){ 
                ls.setItem('fn', n); 
                tg(`ğŸš€ Ú©Ø§Ø±Ø¨Ø± ÙˆØ§Ø±Ø¯ Ø´Ø¯: ${n}`); 
                ck(); 
            }
        }

        function ck(){
            const u=ls.getItem('fn'); 
            document.getElementById('s-pg').style.display=u?'none':'block'; 
            document.getElementById('m-pg').style.display=u?'block':'none';
            if(u){
                document.getElementById('hu').innerText=`Ø³Ù„Ø§Ù… ${u}`;
                const b=parseInt(ls.getItem('fb')||'0'); 
                document.getElementById('bs').innerText=`Highest Score: ${b}%`;
                let s=''; for(let i=0;i<5;i++) s+=i<Math.floor(b/20)?'<i class="fas fa-star"></i>':'<i class="far fa-star"></i>';
                document.getElementById('sd').innerHTML=s;
            }
        }

        function op(){
            document.getElementById('prog').style.display='block'; 
            const h=JSON.parse(ls.getItem('fh')||'[]'); 
            const l=document.getElementById('hl'); l.innerHTML=''; let t=0;
            if(!h.length){ l.innerHTML='<div class="card">Ù‡Ù†ÙˆØ² ØªÙ…Ø±ÛŒÙ†ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒØ¯.</div>'; return; }
            h.slice(-10).reverse().forEach((s,i)=>{ t+=s; l.innerHTML+=`<div class="card" style="display:flex;justify-content:space-between;padding:8px 15px;"><span>ØªÙ…Ø±ÛŒÙ† ${h.length - i}</span><b>${s}%</b></div>`; });
            const a=Math.round(t/Math.min(h.length,10)); 
            document.getElementById('ap').innerText=a+'%'; 
            setTimeout(()=>document.getElementById('pf').style.width=a+'%',100);
        }

        function cp(){ document.getElementById('prog').style.display='none'; }
        function lo(){ if(confirm('Ø§Ø² Ø­Ø³Ø§Ø¨ Ø®Ø§Ø±Ø¬ Ù…ÛŒâ€ŒØ´ÙˆÛŒØ¯ØŸ')){ ls.clear(); location.reload(); }}
        function go(m){ ls.setItem('qm', m); location.href='quiz.html'; }

        window.onload=()=>{ if(ls.getItem('t')==='d') th(); ck(); };
    </script>
</body>
</html>
